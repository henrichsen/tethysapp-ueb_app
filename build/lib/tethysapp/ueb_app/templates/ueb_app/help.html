{% extends "ueb_app/home.html" %}
{% load staticfiles %}
{% load tethys_gizmos %}

{% block app_content_override %}

<!--side bar section-->
<!--<div id='side-bar-container' class='col-md-2'style="margin-bottom:30px">-->
<!--</div>-->


<!--main section -->
<div id='main-container' class="col-md-8">

    <!-- help intro-->
    <div id='title' style="margin-top:40px;margin-bottom:50px">
        <h3 style="color:#0073e6">Help</h3>
        <p class='sub-description'>This page provides the following help information:</p>

        <ul class='help-list'>
            <li> A tutorial about how to use the web app for snowmelt modeling and share the results in HydroShare.</li>
            <li> An introduction of Utah Energy Balance (UEB) model which the web app was built for. </li>
            <li> The general design of the web app which can be applied for other hydrologic modeling web services.</li>
        </ul>

    </div>

    <!-- materials list -->
    <div class="panel-group" id="accordion">


        <!-- quick start tutorial -->
        <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse1" class="accordion-title">
                    Quick Start Tutorial </a>
              </h4>
            </div>

            <div id="collapse1" class="panel-collapse collapse">
              <div class="panel-body">
                <!-- brief intro-->
                <p class="sub-title"> Introduction </p>
                <p class="sub-description">
                    This tutorial shows how to use the Utah Energy Balance Model app to prepare the model input package and execute the model
                    to simulate the snowmelt process for Animas watershed in Colorado River Basin for the 2010 water year.
                    The corresponding data and metadata will be automatically curated in HydroShare to support data sharing and analysis.
                </p>
                <figure>
                    <img width='55%' height="60%" src="{% static 'ueb_app/images/help_watershed.png' %}"/>
                    <figcaption> <strong> Figure 1. Map of Animas watershed in Colorado River Basin </strong></figcaption>
                </figure>

                <!-- model input-->
                <p class="sub-title"> Create a model input package </p>
                <p class="sub-description">
                 In this section, we will use the "Input Data Preparation" to create a complete model input package for Animas watershed.
                 <br>
                 <br><strong>Operation steps:</strong>
                 <br> -> Go to "Input Data Preparation" page.
                 <br> -> Enter the form using the information shown in Figure 2.
                 <br> -> Click on "Input Data preparation" green button.
                 <br> -> Go to "Check status" page to check the job status (Figure 3 JobID 234).
                 <br> -> After the job is finished, click on the link of the model instance resource in HydroShare (Figure 4).

                 <br>
                 <br><strong>Results:</strong>
                 <br>-> The model instance resource stores the model input package and associated metadata.
                        This resource will be used to execute the UEB model.
                        <a target='_blank' href="https://www.hydroshare.org/resource/1235c26fc4d04b2e987f7b3ed8515840/">Check resource here</a>
                 <br>-> The model input package includes model input datasets, model parameter setting files, and
                        a python file which documents the workflow of model input data creation using HydroDS web services.
                </p>

                <figure>
                    <img width='80%' height="80%" src="{% static 'ueb_app/images/help_input_1.png' %}"/>
                    <figcaption> <strong> Figure 2. The form input in "Input Data Preparation" page </strong></figcaption>
                </figure>

                <figure>
                    <img width='80%' height="80%" src="{% static 'ueb_app/images/help_job.png' %}"/>
                    <figcaption> <strong> Figure 3. Check the job status of the submitted work </strong></figcaption>
                </figure>
                  <br>
                <figure>
                    <img width='80%' height="80%" src="{% static 'ueb_app/images/help_input_2.png' %}"/>
                    <figcaption> <strong> Figure 4. The model instance resource shares the model input/output data and metadata </strong></figcaption>
                </figure>
                  <br>


                <!-- model execution-->
                <p class="sub-title"> Execute the model </p>
                <p class="sub-description">
                 In this section, we will use the "Submit for Execution" to use UEB model and simulate the snowmelt process for Animas watershed.
                 <br>
                 <br><strong>Operation steps:</strong>
                 <br> -> Go to "Submit for Execution" page.
                 <br> -> Select the created model instance resource (Figure 5).
                 <br> -> Click on "Submit Model Execution" green button.
                 <br> -> Go to "Check status" page to check the job status (Figure 3 JobID 235).
                 <br> -> After the job is finished, click on the link of the model instance resource in HydroShare (Figure 4).


                 <br>
                 <br><strong>Results:</strong>
                 <br>-> The same model instance resource now is added with a model output package including results of
                        snow water equivalent and surface water total input.
                        <a target='_blank' href="https://www.hydroshare.org/resource/1235c26fc4d04b2e987f7b3ed8515840/">Check resource here</a>
                 <br>-> Users can have multiple model simulation for the same model instance resource and have multiple model output packages in the resource.
                 <br>-> If the model instance resource is deleted before the model simulation is completed,
                         a new model instance resource will be automatically created for data sharing in HydroShare.
                </p>

                <figure>
                    <img width='80%' height="80%" src="{% static 'ueb_app/images/help_run.png' %}"/>
                    <figcaption> <strong> Figure 5. Select model instance resource for model simulation </strong></figcaption>
                </figure>


              <!--&lt;!&ndash; data analysis&ndash;&gt;-->
              <!--<p class="sub-title"> 3. Data analysis </p>-->
              <!--<p class="sub-description">-->


              <!--</p>-->

              </div>
            </div>
         </div>


        <!-- model theory -->
        <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse2" class="accordion-title">
                    Basics of UEB Model</a>
              </h4>
            </div>

            <div id="collapse2" class="panel-collapse collapse">
              <div class="panel-body">

                  <!-- model theory-->
                  <p class="sub-title"> Basic model theory </p>
                  <p class="sub-description">
                      Utah Energy Balance (UEB) model was developed for the prediction of rapid snowmelt rates potentially
                      responsible for soil erosion and surface water inputs.
                      UEB model is driven by inputs of air temperature, precipitation, wind speed, humidity and radiation at time steps
                      sufficient to resolve the diurnal cycle (hourly or six hourly).
                      The model uses physically-based calculations of radiative, sensible, latent and advective heat exchanges (See Figure 1-2).
                  </p>

                  <figure>
                    <img width='55%' height="55%" src="{% static 'ueb_app/images/help_model_theory1.png' %}"/>
                    <img width='55%' height="55%" src="{% static 'ueb_app/images/help_model_theory2.png' %}"/>
                  </figure>

                  <!-- model input/output-->
                  <p class="sub-title"> Model input/output variables</p>
                  <p class="sub-description">
                        <strong>UEB input/output variables can be classified into the following four groups.</strong>
                        <br> -> Spatially constant and constant in time(SCTC)
                        <br> -> Spatially variable but constant in time(SVTC)
                        <br> -> Spatially constant but time varying (SCTV)
                        <br> -> Spatially variable and variable in time (SVTV)
                  </p>

                  <p class="sub-description">
                      <strong> Fig3 illustrates how different model variables are managed.</strong>
                      <br> -> Model parameters are always SCTC. Site Variables may be SCTC or SVTC.
                      The strategy for these is to have a text file that either gives the value for the variable
                      if it is SCTC or the corresponding spatial grid (netCDF) file if it is SVTC.

                      <br> -> Input variables may be SCTV or SVTV.
                      The strategy for these is to have a text file that either gives the value for the variable for each
                      time step if it is SCTV, or the name of a grid file holding the value for each time step if it is SVTV.

                      <br> -> Output variables are grouped into grid output and aggregated outputs.Grid outputs are SVTV.
                      The strategy is to have a text file that lists the grid output variables to be written.
                      These will then be output as netCDF files.  Similarly a text file will specify which aggregate
                      variables to output and outputs will go into text files.
                  </p>

                  <figure>
                    <img width='90%' height="110%" src="{% static 'ueb_app/images/help_model_theory3.png' %}"/>
                    <figcaption> <strong> Figure 3. Input/Output control schematic </strong></figcaption>
                  </figure>

                  <!-- references-->
                  <p class="sub-title"> References</p>
                  <ul class="help-list">
                      <li>Sen Gupta, A., D. G. Tarboton, P. Hummel, M. E. Brown and S. Habib, (2015), "Integration of an energy balance snowmelt model into an open source modeling framework," Environmental Modelling & Software, 68: 205-218, http://dx.doi.org/10.1016/j.envsoft.2015.02.017.</li>
                      <li>Mahat, V., D. G. Tarboton and N. P. Molotch, (2013), "Testing above and below canopy representations of turbulent fluxes in an energy balance snowmelt model," Water Resources Research, 49(2): 1107-1122, http://dx.doi.org/10.1002/wrcr.20073.</li>
                      <li>Mahat, V. and D. G. Tarboton, (2012), "Canopy radiation transmission for an energy balance snowmelt model," Water Resour. Res., 48: W01534, http://dx.doi.org/10.1029/2011WR010438. Correction http://dx.doi.org/10.1029/2012WR011964.</li>
                      <li>Tarboton, D. G. and C. H. Luce, (1996), "Utah Energy Balance Snow Accumulation and Melt Model (UEB)," Computer model technical description and users guide, Utah Water Research Laboratory and USDA Forest Service Intermountain Research Station. http://hydrology.usu.edu/dtarb/snow/snowrep.pdf</li>
                  </ul>

              </div>
            </div>
         </div>

        <!-- web app design-->
        <div class="panel panel-default">
            <div class="panel-heading">
              <h4 class="panel-title">
                <a data-toggle="collapse" data-parent="#accordion" href="#collapse3" class="accordion-title">
                    Web App Design</a>
              </h4>
            </div>

            <div id="collapse3" class="panel-collapse collapse">
              <div class="panel-body">

                  <!-- general idea-->
                  <p class="sub-title"> General idea </p>
                  <p class="sub-description">
                      This web app is part of the work which integrates HydroShare with third party hydrologic modeling
                      web services HydroDS to support reproducible modeling work. HydroDS is a set of web services for
                      model input preparation and execution (here applied for the Utah Energy Balance model).
                  </p>
                  <p class="sub-description">
                      We took HydroShare, HydroShare Apps, and HydroDS to play different roles (See Figure 1):
                      </br> -> <strong>HydroShare Apps</strong> provides the graphical user interface (Utah Energy Balance Model App) for the HydroDS web services.
                      </br> -> <strong>HydroDS</strong> supports model input preparation, model simulation, and data transfer to HydroShare.
                      </br> -> <strong>HydroShare</strong> curates and shares the data from HydroDS and supports online programing environment (e.g. JupyterHub app) for  data analysis.
                  </p>

                  <figure>
                    <img width='55%' height="55%" src="{% static 'ueb_app/images/help_design.png' %}"/>
                    <figcaption> <strong> Figure 1. General design of system integration</strong></figcaption>
                  </figure>

                  <!-- web app development-->
                  <p class="sub-title"> Web app development </p>
                  <p class="sub-description">
                      This web app is developed as a Tethys web app. Details include:
                      </br> -> Tethys web app tutorial: <a target="_blank" href="http://docs.tethysplatform.org/en/stable/tutorials.html">http://docs.tethysplatform.org/en/stable/tutorials.html</a>
                      </br> -> Utah Energy Balance Model App code: <a target="_blank" href="https://github.com/gantian127/tethysapp-ueb_app"> https://github.com/gantian127/tethysapp-ueb_app</a>
                  </p>
                  <p class="sub-description">
                      This web app utilized the HydroDS python client "hydrogate" to send requests to HydroDS. Detials include:
                      </br> -> HydroDS web services code: <a target="_blank" href='https://github.com/CI-WATER/Hydro-DS'>https://github.com/CI-WATER/Hydro-DS</a>
                      </br> -> HydroDS python client code: <a target="_blank" href='https://github.com/CI-WATER/hydrogate_python_client'>'https://github.com/CI-WATER/hydrogate_python_client</a>
                  </p>

              </div>
            </div>
         </div>

    </div>




</div> <!--end of main section -->


{%endblock%}


{% block content_dependent_styles %}
  {{ block.super }}
  <link href="{% static 'ueb_app/css/help.css' %}" rel="stylesheet"/>
{% endblock %}